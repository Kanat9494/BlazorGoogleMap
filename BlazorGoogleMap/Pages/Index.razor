@page "/"

<div class="row">
    <div class="col-xl-6">
        <h3>
            <RadzenCheckBox @bind-Value="@showMadridMarker" />
            <button @onclick="@DisplayPosition">Посмотреть позиции</button>
        </h3>

        <RadzenGoogleMap style="height: 600px;" Zoom="@zoom" Center="@(new GoogleMapPosition() {Lat = 42.6977, Lng = 23.3219})"
                         MapClick="@OnMapClick" MarkerClick="@OnMarkerClick" >
            @*<Markers >
        
                @if (searchPosition)
                {
                    foreach (var item in googleMapPositions)
                    {
                        <RadzenGoogleMapMarker Title="Paris" Label="Paris" Position="@item" />

                    }
                    
                }


            </Markers>*@
        </RadzenGoogleMap>
    </div>

    <div class="col-xl-6">
        <label>Position: </label>@clickedPosition
    </div>
</div>

@code
{
    int zoom = 15;
    bool showMadridMarker;
    bool searchPosition = false;
    string clickedPosition = "";
    //double Latitude = 0; double Longitude = 0;




    void OnMapClick(GoogleMapClickEventArgs args)
    {
        clickedPosition = $"Map clicked LAT: {args.Position.Lat}, LNG: {args.Position.Lng}";
    }

    void OnMarkerClick(RadzenGoogleMapMarker args)
    {
        clickedPosition = $"Map {args.Title} clicked LAT: {args.Position.Lat}, LNG: {args.Position.Lng}";
    }

    List<RadzenGoogleMapMarker> positions = new List<RadzenGoogleMapMarker>() 
    {
        new RadzenGoogleMapMarker()
        {
            Position = new GoogleMapPosition() {Lat = 42.69511995155306, Lng = 23.323037256622303}
        },
        new RadzenGoogleMapMarker()
        {
            Position = new GoogleMapPosition() {Lat = 42.698778668389004, Lng = 23.31539832534789}
        },
        new RadzenGoogleMapMarker()
        {
            Position = new GoogleMapPosition() {Lat = 42.6979586299108, Lng = 23.311321367645252}
        }
    };
    //positions = new List<RadzenGoogleMapMarker>()
    //{
    //    new RadzenGoogleMapMarker()
    //    {
    //        Position = new GoogleMapPosition() {Lat = 42.69511995155306, Lng = 23.323037256622303}
    //    },
    //    new RadzenGoogleMapMarker()
    //    {
    //        Position = new GoogleMapPosition() {Lat = 42.698778668389004, Lng = 23.31539832534789}
    //    },
    //    new RadzenGoogleMapMarker()
    //    {
    //        Position = new GoogleMapPosition() {Lat = 42.6979586299108, Lng = 23.311321367645252}
    //    }
    //};
    List<GoogleMapPosition> googleMapPositions;
    void DisplayPosition()
    {
        searchPosition = true;
        


        googleMapPositions = new List<GoogleMapPosition>()
        {
            new GoogleMapPosition() { Lat = 42.69511995155306, Lng = 23.323037256622303 },
            new GoogleMapPosition() {Lat = 42.698778668389004, Lng = 23.31539832534789}
        };
        //for (int i = 0; i < 3; i++)
        //{
        //    if (i == 0)
        //    {
        //        Latitude = 42.69511995155306;
        //        Longitude = 23.323037256622303;
        //        searchPosition = true;

        //        await Task.Delay(2000);

        //    }

        //    if (i == 1)
        //    {
        //        Latitude = 42.698778668389004;
        //        Longitude = 23.31539832534789;

        //        await Task.Delay(2000);

        //    }

        //    if (i == 2)
        //    {
        //        Latitude = 42.6979586299108;
        //        Longitude = 23.311321367645252;

        //        await Task.Delay(2000);

        //    }
        //}
    }


    public class Location
    {
        public double Latitude { get; set; }
        public double Longitude { get; set; }
    }
}
